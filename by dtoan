local Dtoan = loadstring(game:HttpGet('https://raw.githubusercontent.com/duytoan429/Menu/refs/heads/main/sourcebydtoan.lua.txt'))()
local Window = Dtoan:CreateWindow({
    Name = "Dtoan",
    Icon = 0,
    LoadingTitle = "Dtoan",
    Theme = "Default",
    ToggleUIKeybind = "K",
    DisableDtoanPrompts = false,
    DisableBuildWarnings = false,
    ConfigurationSaving = {Enabled = true, FolderName = nil, FileName = "Dtoan Hub"},
    Discord = {Enabled = false, Invite = "https://discord.gg/9Xhw2AMKw", RememberJoins = true},
    KeySystem = false,
    KeySettings = {Title = "Untitled", FileName = "Key", SaveKey = true, GrabKeyFromSite = false, Key = {"Hello"}}
})

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera

local BloxFruitTab = Window:CreateTab("Blox Fruit", 4483362458)
BloxFruitTab:CreateButton({Name = "Speed Hub", Callback = function() loadstring(game:HttpGet("https://raw.githubusercontent.com/AhmadV99/Speed-Hub-X/main/Speed%20Hub%20X.lua"))() end})
BloxFruitTab:CreateButton({Name = "Teddy Hub", Callback = function() repeat task.wait() until game:IsLoaded() and game.Players.LocalPlayer:FindFirstChild("PlayerGui") loadstring(game:HttpGet("https://raw.githubusercontent.com/Teddyseetink/Haidepzai/refs/heads/main/TEDDYHUB-FREEMIUM"))() end})
BloxFruitTab:CreateButton({Name = "Kiwi Hub", Callback = function() loadstring(game:HttpGet("https://raw.githubusercontent.com/HieuDepTrai-Z/KiwiHubFree/refs/heads/main/KiwiHub.lua"))() end})
BloxFruitTab:CreateButton({Name = "Doraemon Hub", Callback = function() loadstring(game:HttpGet("https://raw.githubusercontent.com/KiddoHiru/BloxFruits/main/MasterHub.lua"))() end})
BloxFruitTab:CreateButton({Name = "Zee Hub", Callback = function() loadstring(game:HttpGet("https://zuwz.me/Ls-Zee-Hub"))() end})
BloxFruitTab:CreateButton({Name = "Đạt Thg", Callback = function() loadstring(game:HttpGet("https://raw.githubusercontent.com/LuaCrack/DatThg/refs/heads/main/DatThgV2"))() end})
BloxFruitTab:CreateButton({Name = "Maru Hub", Callback = function() loadstring(game:HttpGet("https://raw.githubusercontent.com/trongdeptraihucscript/MaruHubPremium/refs/heads/main/MaruHubPremium.lua"))() end})
BloxFruitTab:CreateButton({Name = "W Azure", Callback = function() loadstring(game:HttpGet("https://api.luarmor.net/files/v3/loaders/85e904ae1ff30824c1aa007fc7324f8f.lua"))() end})
BloxFruitTab:CreateButton({Name = "Quantum Hub", Callback = function() loadstring(game:HttpGet("https://raw.githubusercontent.com/flazhy/QuantumOnyx/refs/heads/main/QuantumOnyx.lua"))() end})
BloxFruitTab:CreateButton({Name = "Astral Hub", Callback = function() loadstring(game:HttpGet("https://raw.githubusercontent.com/Overgustx2/Main/refs/heads/main/BloxFruits_25.html"))() end})

local GrowGardenTab = Window:CreateTab("Grow A Garden", 4483362458)
GrowGardenTab:CreateButton({Name = "Grow Hub", Callback = function() loadstring(game:HttpGet("URL_HUB_GROW_A_GARDEN"))() end})

local ForestTab = Window:CreateTab("99 Night In The Forest", 4483362458)
ForestTab:CreateButton({Name = "Forest Hub", Callback = function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/duytoan429/ForestHub/main/99Night.lua"))()
end})

local CrossoverTab = Window:CreateTab("Crossover", 4483362458)
CrossoverTab:CreateButton({Name = "Goomba Hub (Arise Crossover)", Callback = function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/JustLevel/goombahub/main/AriseCrossover.lua"))()
end})

local BrainrotTab = Window:CreateTab("Steal a Brainrot", 4483362458)
BrainrotTab:CreateButton({Name = "Brainrot Hub", Callback = function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/duytoan429/BrainrotHub/main/StealABrainrot.lua"))()
end})

local aimEnabled = false
local fovRadius = 120
local aimSmooth = 0.35
local MIN_FOV, MAX_FOV = 20, 1000
local MIN_SMOOTH, MAX_SMOOTH = 0.01, 1
local wallCheckEnabled = true
local whitelist = {workspace.Terrain}
local espEnabled = false
_G.FriendColor = Color3.fromRGB(0,0,255)
_G.EnemyColor = Color3.fromRGB(255,0,0)
_G.UseTeamColor = true

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AimBot_FOVGui"
screenGui.ResetOnSpawn = false
screenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

local fovFrame = Instance.new("Frame", screenGui)
fovFrame.AnchorPoint = Vector2.new(0.5, 0.5)
fovFrame.Position = UDim2.new(0.5,0,0.5,0)
fovFrame.BackgroundTransparency = 1
fovFrame.Visible = false

local fovStroke = Instance.new("UIStroke", fovFrame)
fovStroke.Thickness = 2
fovStroke.Transparency = 0.3
local fovCorner = Instance.new("UICorner", fovFrame)
fovCorner.CornerRadius = UDim.new(1,0)

local function updateFOVVisual()
    local diameter = math.clamp(fovRadius*2, MIN_FOV, MAX_FOV)
    fovFrame.Size = UDim2.new(0, diameter, 0, diameter)
    fovFrame.Position = UDim2.new(0.5,0,0.5,0)
end
updateFOVVisual()

local hue = 0
RunService.RenderStepped:Connect(function(dt)
    hue = (hue + dt*0.2) % 1
    fovStroke.Color = Color3.fromHSV(hue,1,1)
end)

local function applyESP(player)
    if not player.Character then return end
    local color
    if _G.UseTeamColor then
        color = player.TeamColor.Color
    else
        color = (player.TeamColor == LocalPlayer.TeamColor) and _G.FriendColor or _G.EnemyColor
    end
    if not player.Character:FindFirstChild("GetReal") then
        local highlight = Instance.new("Highlight")
        highlight.Name = "GetReal"
        highlight.RobloxLocked = true
        highlight.Adornee = player.Character
        highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
        highlight.FillColor = color
        highlight.OutlineColor = Color3.new(0,0,0)
        highlight.Parent = player.Character
    else
        player.Character.GetReal.FillColor = color
    end
end

local function isVisible(part)
    if not part or not part.Parent then return false end
    if not wallCheckEnabled then return true end
    local origin = Camera.CFrame.Position
    local direction = part.Position - origin
    local rayParams = RaycastParams.new()
    rayParams.FilterType = Enum.RaycastFilterType.Blacklist
    rayParams.FilterDescendantsInstances = {LocalPlayer.Character, unpack(whitelist)}
    local result = workspace:Raycast(origin, direction, rayParams)
    if result then
        return result.Instance:IsDescendantOf(part.Parent)
    end
    return true
end

RunService.RenderStepped:Connect(function()
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer then
            if espEnabled then
                applyESP(player)
            elseif player.Character and player.Character:FindFirstChild("GetReal") then
                player.Character.GetReal:Destroy()
            end
        end
    end
    if aimEnabled then
        local center = Vector2.new(Camera.ViewportSize.X/2, Camera.ViewportSize.Y/2)
        local bestPart, bestDist = nil, math.huge
        for _, player in pairs(Players:GetPlayers()) do
            if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("Head") and player.Character:FindFirstChild("Humanoid") and player.Character.Humanoid.Health > 0 then
                local head = player.Character.Head
                local screenPos, onScreen = Camera:WorldToViewportPoint(head.Position)
                local d = (Vector2.new(screenPos.X, screenPos.Y) - center).Magnitude
                if onScreen and d <= fovRadius and d < bestDist and isVisible(head) then
                    bestDist = d
                    bestPart = head
                end
            end
        end
        if bestPart then
            Camera.CFrame = Camera.CFrame:Lerp(CFrame.new(Camera.CFrame.Position, bestPart.Position), aimSmooth)
        end
    end
end)

local AimTab = Window:CreateTab("Aim bot", 4483362458)
AimTab:CreateToggle({Name = "Aimbot", CurrentValue = aimEnabled, Callback = function(Value) aimEnabled = Value fovFrame.Visible = Value end})
AimTab:CreateToggle({Name = "Wall Check", CurrentValue = wallCheckEnabled, Callback = function(Value) wallCheckEnabled = Value end})
AimTab:CreateButton({Name = "Reset Defaults", Callback = function() aimEnabled = false fovRadius = 120 aimSmooth = 0.35 wallCheckEnabled = true fovFrame.Visible = false updateFOVVisual() end})
AimTab:CreateSlider({Name = "FOV (pixels)", Range = {MIN_FOV, MAX_FOV}, Increment = 10, CurrentValue = fovRadius, Callback = function(Value) fovRadius = Value updateFOVVisual() end})
AimTab:CreateSlider({Name = "Aim Smooth", Range = {MIN_SMOOTH, MAX_SMOOTH}, Increment = 0.01, CurrentValue = aimSmooth, Callback = function(Value) aimSmooth = Value end})

local ESPTab = Window:CreateTab("ESP", 4483362458)
ESPTab:CreateToggle({Name = "Enable ESP", CurrentValue = espEnabled, Callback = function(Value) espEnabled = Value end})
ESPTab:CreateColorPicker({Name = "Friend Color", Color = _G.FriendColor, Callback = function(Value) _G.FriendColor = Value end})
ESPTab:CreateColorPicker({Name = "Enemy Color", Color = _G.EnemyColor, Callback = function(Value) _G.EnemyColor = Value end})
ESPTab:CreateToggle({Name = "Use Team Color", CurrentValue = _G.UseTeamColor, Callback = function(Value) _G.UseTeamColor = Value end})

local OtherTab = Window:CreateTab("Khác", 4483362458)
local InfiniteJumpEnabled = false
OtherTab:CreateToggle({Name = "Infinity Jump", CurrentValue = false, Callback = function(Value) InfiniteJumpEnabled = Value end})
UserInputService.JumpRequest:Connect(function()
    if InfiniteJumpEnabled and LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid") then
        LocalPlayer.Character:FindFirstChildOfClass("Humanoid"):ChangeState("Jumping")
    end
end)
OtherTab:CreateSlider({Name = "Player Speed", Range = {16,200}, Increment = 5, CurrentValue = 16, Callback = function(Value)
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid") then
        LocalPlayer.Character:FindFirstChildOfClass("Humanoid").WalkSpeed = Value
    end
end})

local noclipEnabled = false
local noclipConnection
OtherTab:CreateToggle({Name = "Noclip (xuyên vật thể)", CurrentValue = false, Callback = function(Value)
    noclipEnabled = Value
    if noclipEnabled then
        noclipConnection = RunService.Stepped:Connect(function()
            if LocalPlayer.Character then
                for _, part in pairs(LocalPlayer.Character:GetChildren()) do
                    if part:IsA("BasePart") then part.CanCollide = false end
                end
            end
        end)
    elseif noclipConnection then
        noclipConnection:Disconnect()
        noclipConnection = nil
    end
end})

OtherTab:CreateToggle({Name = "Fly Gui", CurrentValue = false, Callback = function(Value)
    if Value then
        loadstring(game:HttpGet("https://raw.githubusercontent.com/XNEOFF/FlyGuiV3/main/FlyGuiV3.txt"))()
    end
end})

local orbitEnabled = false
local distanceBehind = 5
local bodyPos
local currentTarget = nil

OtherTab:CreateToggle({Name = "Orbit Behind Player", CurrentValue = false, Callback = function(Value)
    orbitEnabled = Value
    local character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local rootPart = character:WaitForChild("HumanoidRootPart")
    if orbitEnabled and not bodyPos then
        bodyPos = Instance.new("BodyPosition")
        bodyPos.MaxForce = Vector3.new(1e5,1e5,1e5)
        bodyPos.D = 10
        bodyPos.P = 3000
        bodyPos.Parent = rootPart
    elseif not orbitEnabled and bodyPos then
        bodyPos:Destroy()
        bodyPos = nil
    end
end})

OtherTab:CreateSlider({Name = "Orbit Distance", Range = {1,20}, Increment = 1, CurrentValue = distanceBehind, Callback = function(Value)
    distanceBehind = Value
end})

local function getClosestAlivePlayer()
    local closestDist = math.huge
    local closestPlayer = nil
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") and player.Character.Humanoid.Health > 0 then
            local dist = (player.Character.HumanoidRootPart.Position - LocalPlayer.Character.HumanoidRootPart.Position).Magnitude
            if dist < closestDist then
                closestDist = dist
                closestPlayer = player
            end
        end
    end
    return closestPlayer
end

RunService.RenderStepped:Connect(function()
    if orbitEnabled then
        local character = LocalPlayer.Character
        if not character or not character:FindFirstChild("HumanoidRootPart") then return end
        if not currentTarget or not currentTarget.Character or not currentTarget.Character:FindFirstChild("HumanoidRootPart") then
            currentTarget = getClosestAlivePlayer()
        end
        if currentTarget and currentTarget.Character and currentTarget.Character:FindFirstChild("HumanoidRootPart") and bodyPos then
            local targetRoot = currentTarget.Character.HumanoidRootPart
            local backPos = targetRoot.Position - targetRoot.CFrame.LookVector * distanceBehind
            bodyPos.Position = backPos
        end
    end
end)

fovFrame.Visible = aimEnabled
updateFOVVisual()
